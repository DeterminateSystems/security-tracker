{% extends "base.html" %}
{% from "_formhelpers.html" import nullable_value, colorize_severity, colorize_status, bug_ticket %}

{% block content %}
	<h1>Security Tracker</h1>
	<table class="styled_table wide_size">
		<thead>
			<tr>
				<th>Group</th>
				<th>Issue</th>
				<th>Package</th>
				<th>Affected</th>
				<th>Fixed</th>
				<th>Severity</th>
				<th>Status</th>
				<th>Ticket</th>
				<th>Advisory</th>
			</tr>
		</thead>
		<tbody>
		{% for entry in entries %}
			<tr>
				<td><a href="/{{ entry.group.name }}">{{ entry.group.name }}</a></td>
				<td>
					{% for cve in entry.cves %}
						<a href="/{{ cve.id }}">{{ cve.id }}</a>{% if not loop.last %}<br />{% endif %}
					{% endfor %}
				</td>
				<td class="wrap">
				{% for pkg in entry.pkgs %}
					<a href="/package/{{ pkg }}">{{ pkg }}</a>{% if not loop.last %}, {% endif %}
				{% endfor %}
				</td>
				<td>{{ entry.group.affected }}</td>
				<td>{{ entry.group.fixed }}</td>
				<td>{{ colorize_severity(entry.group.severity) }}</td>
				<td>{{ colorize_status(entry.group.status) }}</td>
				<td>{{ bug_ticket(entry.group.bug_ticket) }}</td>
				<td>
				{% for advisory in entry.advisories %}
					<a href="/{{ advisory }}">{{ advisory }}</a>{% if not loop.last %}<br/>{% endif %}
				{% endfor %}
				</td>
			</tr>
		{% endfor %}
		</tbody>
	</table>
{% endblock %}
